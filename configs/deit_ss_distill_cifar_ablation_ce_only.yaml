# Ablation: CE-only (no distillation signal)
# Same setup as CST-v1, but lambda_tok=0 and lambda_rel=0
# Expected: ~86% (same as ViT baseline)

data:
  augmentation:
    random_crop: true
    random_flip: true
    color_jitter: true
    cutout: true
    randaugment: true
    randaugment_n: 2
    randaugment_m: 9
    mixup: true
    mixup_alpha: 0.8
    cutmix: false
    cutmix_alpha: 1.0
  batch_size: 256
  data_path: ./data
  dataset: cifar
  normalization:
    mean: [0.4914, 0.4822, 0.4465]
    std: [0.2470, 0.2435, 0.2616]
  num_workers: 8
  persistent_workers: true
  pin_memory: true
  prefetch_factor: 2

device: cuda
experiment_name: deit_ablation_ce_only
output_dir: ./outputs
seed: 42

logging:
  log_dir: ./logs
  log_level: INFO
  save_frequency: 10
  track_grad_norm: true
  wandb: false

model:
  model_type: deit
  in_channels: 3
  num_classes: 10
  architecture: []
  classifier_layers: []
  dropout: 0.0
  use_se: false

vit:
  variant: tiny
  img_size: 32
  patch_size: 4
  embed_dim: 192
  depth: 12
  num_heads: 3
  mlp_ratio: 2.0
  drop_rate: 0.0
  attn_drop_rate: 0.0
  drop_path_rate: 0.1
  distillation: true
  convert_grayscale: false
  use_conv_stem: true
  cls_token_dropout: 0.1
  inference_mode: avg

ss_distillation:
  teacher_type: dinov2
  teacher_model_name: dinov2_vits14
  teacher_embed_dim: 384
  token_layers: [6, 11]
  projection_dim: 256
  # ABLATION: No distillation signal
  lambda_tok: 0.0
  lambda_rel: 0.0
  token_loss_type: cosine
  correlation_temperature: 0.1
  correlation_loss_type: kl
  use_pooled_correlation: true
  rel_warmup_epochs: 10
  projector_warmup_epochs: 0

training:
  num_epochs: 100
  learning_rate: 0.001
  weight_decay: 0.05
  optimizer: adamw
  scheduler: cosine
  warmup_epochs: 10
  gradient_clip_val: 1.0
  gradient_accumulation_steps: 1
  use_amp: true
  amp_backend: native
  early_stopping: true
  early_stopping_patience: 20
  early_stopping_min_delta: 0.0005
  lr_scheduler_params:
    T_max: 100
    eta_min: 0.00001
  label_smoothing: 0.1
  use_swa: false
  swa_start_epoch: 0.75
  swa_lr: 0.0001
  use_bf16: true
  use_compile: false
  compile_mode: max-autotune
  use_fused_optimizer: true
  use_tf32: true
